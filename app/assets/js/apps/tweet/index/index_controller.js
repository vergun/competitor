// Generated by CoffeeScript 1.6.3
(function() {
  this.Competitor.module("TweetApp.Index", function(Index, App, Backbone, Mariontte, $, _, Chart) {
    return Index.Controller = {
      showIndex: function() {
        var tweets,
          _this = this;
        tweets = this.getTweets();
        this.layout = this.getIndexLayout();
        tweets.fetch().done(function() {
          return App.mainRegion.show(_this.layout);
        });
        return this.layout.on("show", function() {
          tweets = tweets.models[0];
          tweets.set('activeKeywords', tweets.get('keywords'));
          _this.showHeader(tweets);
          _this.showHeaderNav(tweets);
          _this.showLeftNav(tweets);
          _this.showTweetList(tweets);
          _this.showChart(tweets);
          _this.showChartLegend(tweets);
          _this.showMap(tweets);
          return _this.showSource(tweets);
        });
      },
      updateIndex: function(options) {
        var tweets,
          _this = this;
        if (options == null) {
          options = {};
        }
        tweets = this.getTweets(options);
        return tweets.fetch().done(function() {
          tweets = tweets.models[0];
          tweets.set('activeKeywords', tweets.get('keywords'));
          _this.showHeader(tweets);
          _this.showTweetList(tweets);
          _this.showChart(tweets);
          _this.showChartLegend(tweets);
          _this.showMap(tweets);
          _this.showSource(tweets);
          return App.vent.trigger("remove:loading");
        });
      },
      getTweets: function(options) {
        if (options == null) {
          options = {};
        }
        return App.request("get:index:tweets", options);
      },
      /* layout*/

      getIndexLayout: function() {
        return new Index.Layout;
      },
      /* header*/

      showHeader: function(tweets) {
        this.headerView = this.getHeaderView(tweets);
        return this.layout.headerRegion.show(this.headerView);
      },
      showHeaderNav: function(tweets) {
        this.headernavView = this.getHeaderNavView(tweets);
        this.headernavView.on("update:chart", function(options) {
          this.model.set('chart', options.type);
          $.extend(options, {
            model: this.model
          });
          return App.vent.trigger("update:chart", options);
        });
        this.headernavView.on("update:keywords", function(options) {
          this.model.set('activeKeywords', options.data);
          $.extend(options, {
            model: this.model
          });
          return App.vent.trigger("update:keywords", options);
        });
        return this.layout.headerNavRegion.show(this.headernavView);
      },
      showLoading: function() {
        this.loadingView = this.getLoadingView();
        return this.layout.loadingRegion.show(this.loadingView);
      },
      getLoadingView: function() {
        return new Index.Loading;
      },
      removeLoading: function() {
        return this.layout.loadingRegion.close();
      },
      getHeaderView: function(tweets) {
        return new Index.Header({
          model: tweets
        });
      },
      getHeaderNavView: function(tweets) {
        return new Index.HeaderNav({
          model: tweets
        });
      },
      /* left*/

      showLeftNav: function(tweets) {
        this.sidenavView = this.getLeftNavView(tweets);
        return this.layout.sideNavRegion.show(this.sidenavView);
      },
      getLeftNavView: function(tweets) {
        return new Index.LeftNav({
          model: tweets
        });
      },
      /*  tweet list*/

      showTweetList: function(tweets) {
        console.log(tweets);
        this.tweetListView = this.getTweetListView(tweets);
        return this.layout.tweestListRegion.show(this.tweetListView);
      },
      getTweetListView: function(tweets) {
        return new Index.TweetList({
          model: tweets
        });
      },
      /*  right side*/

      showChart: function(tweets) {
        this.chartView = this.getChartView(tweets);
        return this.layout.chartRegion.show(this.chartView);
      },
      showChartLegend: function(data) {
        this.chartLegendView = this.getChartLegendView(data);
        return this.layout.chartLegendRegion.show(this.chartLegendView);
      },
      getChartView: function(data) {
        return new Index.Chart({
          model: data
        });
      },
      getChartLegendView: function(data) {
        return new Index.ChartLegend({
          model: data
        });
      },
      showMap: function(tweets) {
        this.mapView = this.getMapView(tweets);
        return this.layout.mapRegion.show(this.mapView);
      },
      showSource: function(tweets) {
        this.sourceView = this.getSourceView(tweets);
        return this.layout.sourceRegion.show(this.sourceView);
      },
      getMapView: function(data) {
        return new Index.Map({
          model: data
        });
      },
      getSourceView: function(data) {
        return new Index.Source({
          model: data
        });
      }
    };
  });

}).call(this);
